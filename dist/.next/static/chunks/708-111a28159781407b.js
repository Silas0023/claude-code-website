"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{29017:(e,t,r)=>{r.d(t,{A:()=>p});var a=r(95155),s=r(12115),o=r(52619),n=r.n(o),i=r(20063),l=r(71408),d=r(12025),c=r(59384),h=r(47937),g=r(39347),u=r(20908),m=r(27937),x=r(50803),f=r(84926);function p(e){var t,r,o,p;let{onLogout:b,isMobileMenuOpen:y=!1,setIsMobileMenuOpen:v=()=>{},user:w}=e,k=(0,i.usePathname)(),[j,N]=(0,s.useState)(["使用教程"]);(0,s.useEffect)(()=>{Object.entries({使用教程:["/dashboard/docs","/dashboard/wechat","/dashboard/videos"],会员中心:["/dashboard/upgrade","/dashboard/invite","/dashboard/offers"]}).forEach(e=>{let[t,r]=e;r.includes(k)&&N(e=>e.includes(t)?e:[...e,t])})},[k]);let S=[{label:"概览",href:"/dashboard",icon:(0,a.jsx)(c.A,{className:"w-5 h-5"})},{label:"使用教程",href:"/dashboard/tutorial",icon:(0,a.jsx)(h.A,{className:"w-5 h-5"})},{label:"升级订阅",href:"/dashboard/upgrade",icon:(0,a.jsx)(g.A,{className:"w-5 h-5"}),badge:"PRO"},{label:"帮助中心",href:"https://docs.anthropic.com/zh-CN/docs/claude-code/overview",icon:(0,a.jsx)(u.A,{className:"w-5 h-5"}),external:!0}],I=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=e.children&&e.children.length>0,o=j.includes(e.label),i=!!(t=e.href)&&k===t;return s?(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>{var t;return t=e.label,void N(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"w-full flex items-center justify-between px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-700 ".concat(o?"text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700":"text-gray-600 dark:text-gray-400"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.icon,(0,a.jsx)("span",{children:e.label})]}),(0,a.jsx)("div",{className:"transition-transform ".concat(o?"rotate-90":""),children:(0,a.jsx)(m.A,{className:"w-4 h-4"})})]}),o&&(0,a.jsx)("div",{className:"ml-4 mt-1 space-y-1",children:e.children.map(e=>I(e,r+1))})]},e.label):e.external?(0,a.jsxs)("a",{href:e.href||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 ".concat(i?"bg-gradient-to-r from-orange-100 to-pink-100 dark:from-orange-500/20 dark:to-pink-500/20 text-orange-700 dark:text-white border border-orange-200 dark:border-orange-500/30":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"," ").concat(r>0?"pl-11":""),onClick:()=>v(!1),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.icon,(0,a.jsx)("span",{children:e.label})]}),e.badge&&(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold rounded-full ".concat("PRO"===e.badge?"bg-gradient-to-r from-orange-500 to-pink-500 text-white":"bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-400"),children:e.badge})]},e.label):(0,a.jsxs)(n(),{href:e.href||"#",className:"flex items-center justify-between px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 ".concat(i?"bg-gradient-to-r from-orange-100 to-pink-100 dark:from-orange-500/20 dark:to-pink-500/20 text-orange-700 dark:text-white border border-orange-200 dark:border-orange-500/30":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"," ").concat(r>0?"pl-11":""),onClick:()=>v(!1),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.icon,(0,a.jsx)("span",{children:e.label})]}),e.badge&&(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold rounded-full ".concat("PRO"===e.badge?"bg-gradient-to-r from-orange-500 to-pink-500 text-white":"bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-400"),children:e.badge})]},e.label)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.N,{children:y&&(0,a.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>v(!1),className:"lg:hidden fixed inset-0 bg-black/50 z-40"})}),(0,a.jsxs)("div",{className:"".concat(y?"translate-x-0":"-translate-x-full"," lg:translate-x-0 transition-transform duration-300 fixed lg:static w-64 h-screen bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 flex flex-col z-50"),children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsxs)(n(),{href:"/",className:"flex items-center gap-3 group",onClick:()=>v(!1),children:[(0,a.jsx)("div",{className:"p-2.5 gradient-bg rounded-xl shadow-md group-hover:shadow-lg transition-all",children:(0,a.jsx)(x.A,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Claude Code"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"仪表板概览"})]})]})}),(0,a.jsx)("nav",{className:"flex-1 overflow-y-auto p-4 space-y-1",children:S.map(e=>I(e))}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-pink-50 dark:from-orange-500/10 dark:to-pink-500/10 rounded-xl p-3 mb-3",children:[w&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-400 to-pink-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xs font-bold",children:(null==(t=w.userInfo)?void 0:t.phone)?w.userInfo.phone.charAt(0):"U"})}),(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:(null==(r=w.userInfo)?void 0:r.phone)?w.userInfo.phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"用户"})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"当前套餐"}),(0,a.jsx)("span",{className:"text-xs font-bold text-orange-600 dark:text-orange-400",children:(null==w||null==(o=w.userInfo)?void 0:o.planName)||"FREE"})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:["过期时间: ",(null==w||null==(p=w.userInfo)?void 0:p.subscribeEndTime)?new Date(w.userInfo.subscribeEndTime).toLocaleDateString("zh-CN"):"永不过期"]}),(0,a.jsx)("div",{className:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-pink-500",style:{width:(()=>{var e,t;if(!(null==w||null==(e=w.userInfo)?void 0:e.subscribeStartTime)||!(null==w||null==(t=w.userInfo)?void 0:t.subscribeEndTime))return"100%";let r=new Date(w.userInfo.subscribeStartTime).getTime(),a=new Date(w.userInfo.subscribeEndTime).getTime(),s=Math.max(0,Math.min(100,(Date.now()-r)/(a-r)*100));return"".concat(s,"%")})()}})})]}),(0,a.jsxs)("button",{onClick:()=>{b(),v(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-all duration-200",children:[(0,a.jsx)(f.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"退出登录"})]})]})]})]})}},65380:(e,t,r)=>{r.d(t,{A:()=>l,AuthProvider:()=>i});var a=r(95155),s=r(12115),o=r(90960);let n=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,s.useState)(null),[l,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{let t=JSON.parse(e);i(t)}catch(e){console.error("Error parsing stored user:",e),localStorage.removeItem("user")}d(!1)},[]);let c=async(e,t)=>new Promise((r,a)=>{setTimeout(()=>{if(e&&t){let t={id:"1",email:e,name:e.split("@")[0],avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e)};i(t),localStorage.setItem("user",JSON.stringify(t)),r()}else a(Error("Invalid credentials"))},1e3)}),h=async(e,t)=>{try{let r=await o.K.login(e,t);if(200===r.code||0===r.code){let t={id:r.data.userInfo.id.toString(),email:r.data.userInfo.phone,name:r.data.userInfo.nickname||e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),avatar:r.data.userInfo.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e),phone:r.data.userInfo.phone,token:r.data.token,userInfo:r.data.userInfo};try{let e=await o.K.getUserStats(r.data.userInfo.id.toString());(200===e.code||0===e.code)&&(t.userStats=e.data)}catch(e){console.warn("获取用户统计信息失败:",e)}i(t),localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("token",r.data.token)}else throw Error(r.message||"登录失败")}catch(e){throw Error(e.message||"网络错误，请重试")}},g=async e=>{try{let t=await o.K.sendVerificationCode(e);if(200===t.code||0===t.code)return;throw Error(t.message||"发送验证码失败")}catch(e){throw Error(e.message||"网络错误，请重试")}},u=async()=>{if(!(null==r?void 0:r.id))throw Error("用户未登录");try{let e=await o.K.getUserInfo(r.id);if(200===e.code||0===e.code){let t={...r,userInfo:e.data,name:e.data.nickname||r.name,avatar:e.data.avatar||r.avatar,phone:e.data.phone||r.phone};i(t),localStorage.setItem("user",JSON.stringify(t))}else throw Error(e.message||"获取用户信息失败")}catch(e){throw Error(e.message||"网络错误，请重试")}},m=async()=>{if(!(null==r?void 0:r.id))throw Error("用户未登录");try{let e=await o.K.getUserStats(r.id);if(200===e.code||0===e.code){let t={...r,userStats:e.data};i(t),localStorage.setItem("user",JSON.stringify(t))}else throw Error(e.message||"获取用户统计信息失败")}catch(e){throw Error(e.message||"网络错误，请重试")}},x=async()=>{if(!(null==r?void 0:r.id))throw Error("用户未登录");try{let[t,a]=await Promise.all([o.K.getUserInfo(r.id),o.K.getUserStats(r.id)]),s={...r};if(200===t.code||0===t.code){var e;s={...s,userInfo:{...t.data,planName:(null==(e=t.data.subscriptionConfig)?void 0:e.displayName)||"FREE"},name:t.data.nickname||r.name,avatar:t.data.avatar||r.avatar,phone:t.data.phone||r.phone}}(200===a.code||0===a.code)&&(s={...s,userStats:a.data}),i(s),localStorage.setItem("user",JSON.stringify(s))}catch(e){throw Error(e.message||"网络错误，请重试")}};return(0,a.jsx)(n.Provider,{value:{user:r,isLoading:l,login:c,loginWithPhone:h,sendVerificationCode:g,refreshUserInfo:u,refreshUserStats:m,refreshAllUserData:x,logout:()=>{i(null),localStorage.removeItem("user"),localStorage.removeItem("token")},checkAuth:()=>!!r,setServerUrl:e=>{o.K.setBaseUrl(e)},getServerUrl:()=>o.K.baseUrl||"http://127.0.0.1:8088"},children:t})}function l(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},90960:(e,t,r)=>{r.d(t,{K:()=>s});class a{getBaseUrl(){return localStorage.getItem("api_base_url")||"https://ai01.zjczwl.cn"}setBaseUrl(e){this.baseUrl=e,localStorage.setItem("api_base_url",e)}getClientIp(){return"127.0.0.1"}async sendVerificationCode(e){let t=await fetch("".concat(this.baseUrl,"/api/claudeApi/sendCode?phone=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return t.json()}async login(e,t){let r=await fetch("".concat(this.baseUrl,"/api/claudeApi/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:e,code:t,loginIp:this.getClientIp()})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return r.json()}async getSubscriptionPlans(){let e=await fetch("".concat(this.baseUrl,"/api/claudeApi/subscriptionPlans"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return e.json()}async getUserInfo(e){let t="".concat(this.baseUrl,"/api/claudeApi/userInfo/").concat(e),r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}async getUserStats(e){let t=await fetch("".concat(this.baseUrl,"/api/claudeApi/userStats/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return t.json()}async getUserModelStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"monthly",r=await fetch("".concat(this.baseUrl,"/api/claudeApi/userModelStats"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiId:e,period:t})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return r.json()}async createOrder(e,t,r){let a=await fetch("".concat(this.baseUrl,"/api/claudeApi/order/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriptionConfigId:e,type:t,userId:r})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return a.json()}constructor(){this.baseUrl=this.getBaseUrl()}}let s=new a}}]);